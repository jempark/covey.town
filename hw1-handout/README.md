Avery’s prototype almost implements the Minimum Viable Product (the first deliverable that satisfies our client’s must have requirements) for Covey.Town, but lacks one crucial feature: support for multiple rooms. The Covey.Town prototype currently consists of a single room: all users that connect to Covey.Town are placed on the same map. Our client is unhappy with this because they really want people to be able to create their own personalized spaces in Covey.Town. Also, since each room is mapped to a single video room in our video calling system, and each video room is limited to only 50 participants, having a single room means that there can only be 50 people on the platform at once.

But, if we can structure the system so that different groups of users join different rooms, then we can satisfy our client’s requirement, while also allowing more than 50 people to use the system at a time, by putting them in different rooms. Avery started implementing this feature, but never got to finish it: apparently Avery’s frontend code is a huge mess of spaghetti too, and Avery’s manager told them to focus on cleaning that up before finishing the product.

While Avery cleans up the frontend code, your task will be to implement this last key feature: adding support for multiple rooms. For this onboarding assignment, you’ll modify Avery’s backend code to support multiple rooms. Once Avery finishes reorganizing the frontend code (and you learn about frontend development in class), you’ll also modify the frontend to support this feature.

Avery previously created the interface ICoveyRoomsStore to define the behavior for a new class, CoveyRoomsStore, which will hold onto a collection of CoveyRoomControllers, one per-room. Your coding task is:

In the (empty) file CoveyRoomsStore.ts, define the new type CoveyRoomsStore, which should be a singleton, and implement the functionality of ICoveyRoomsStore. Note that you’ll need to proceed to step 2 to fully implement this method.
Change the CoveyRoomController so that it is no longer a singleton. Instead, there will be one instance of this type for each room, and those instances will be created by your CoveyRoomsStore. Add a public constructor, and a new private, readonly property, called _coveyRoomID (and a TypeScript-style getter) to CoveyRoomController so that each room controller knows the name of the room that it is mapped to. Update the call to getTokenForRoom to pass this room ID instead of the hard-coded one.
Change the roomSubscriptionHandler and roomJoinHandler to retrieve the correct CoveyRoomController from your CoveyRoomsStore, based on the coveyRoomID requested.
Conveniently (or not so conveniently, depending on how you see it), Avery has already written a comprehensive test suite for this feature. To be deemed acceptable, your code must pass all of these tests, and also have no errors reported by the linter.

You do not need to correct any design flaws that you’ve identified in Avery’s code already (for instance, the naming violations) - when we review your code, we’ll know that this was Avery’s fault, and have them improve their work for next time!
